<!DOCTYPE html>
<html>
<head>
    <title>Shopping cart</title>

    <script src="/sys/object.observe/dist/object-observe.min.js"></script>
    <script src="/sys/array.observe/array-observe.min.js"></script>

    <script src="/sys/webcomponentsjs/webcomponents.js"></script>
    <script>
        window.Polymer = window.Polymer || {};
        window.Polymer.dom = "shadow";
    </script>
    <link rel="import" href="/sys/polymer/polymer.html">

    <!-- Import Starcounter specific components -->
    <link rel="import" href="/sys/starcounter.html">
    <link rel="import" href="/sys/starcounter-include/starcounter-include.html">
    <link rel="import" href="/sys/starcounter-debug-aid/src/starcounter-debug-aid.html">

    <link rel="import" href="/sys/puppet-redirect/puppet-redirect.html" />

    <link rel="import" href="/Playground/ct-list.html" />
</head>
<body>
    <template is="dom-bind" id="root">
        <p>{{model.MessageText}}</p>
        <p>{{model.MessageButton}}</p>
        <fieldset>
            <legend>Text</legend>
            <input type="text" value="{{model.Text$::change}}" />
        </fieldset>
        <fieldset>
            <legend>Button</legend>
            <button type="button" value="{{model.Button$::click}}" onmousedown="++this.value">Click me</button>
        </fieldset>
        <fieldset>
            <legend>Table</legend>
            <table>
                <thead>
                    <tr>
                        <th>
                            <button type="button" value="{{model.AddItem$::click}}" onmousedown="++this.value;">Add item</button>
                            <button type="button" value="{{model.RemoveItem$::click}}" onmousedown="++this.value;">Remove first item</button>
                            <button type="button" value="{{model.AddAndRemoveItem$::click}}" onmousedown="++this.value;">Add and remove item</button>
                            <button type="button" value="{{model.ResetItems$::click}}" onmousedown="++this.value;">Reset items</button>
                            <button type="button" value="{{model.UpdateItem$::click}}" onmousedown="++this.value;">Update first item</button>
                            <button type="button" value="{{model.SaveItems$::click}}" onmousedown="++this.value;">Save changes</button>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <template is="dom-repeat" items="{{model.Items}}">
                        <tr>
                            <td>{{item.Name}}</td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </fieldset>
        <fieldset>
            <legend>List</legend>
            <ul>
                <template is="dom-repeat" items="{{model.Items}}">
                    <li>{{item.Name}}</li>
                </template>
            </ul>
        </fieldset>
        <fieldset>
            <legend>Custom element</legend>
            <ct-list list-items="{{model.Items}}"></ct-list>
        </fieldset>
        <fieldset>
            <legend>Last item</legend>
            <div>{{model.LastItem.Name}}</div>
        </fieldset>
        <fieldset>
            <legend>Sub page</legend>
            <starcounter-include partial="{{model.SubPage}}"></starcounter-include>
            <template is="dom-if" if="{{!model.SubPage.Playground.Html}}">
                <p>The sub page is not loaded</p>
            </template>
            <p>
                <button type="button" value="{{model.LoadSubPage$::click}}" onmouseup="++this.value;" disabled="{{model.LoadSubPage$}}">Load sub page</button>
                <button type="button" value="{{model.UnloadSubPage$::click}}" onmouseup="++this.value;" disabled="{{model.UnloadSubPage$}}">Unload sub page</button>
                <button type="button" value="{{model.ChangeHtmlSubPage$::click}}" onmouseup="++this.value;" disabled="{{model.ChangeHtmlSubPage$}}">Change sub HTML</button>
            </p>
        </fieldset>
        <fieldset>
            <legend>Sub pages</legend>
            <template is="dom-if" if="{{model.SubPages.length}}">
                <template is="dom-repeat" items="{{model.SubPages}}">
                    <starcounter-include partial="{{item}}"></starcounter-include>
                </template>
            </template>
            <p>
                <button type="button" value="{{model.AddSubPage$::click}}" onmouseup="++this.value;" disabled="{{model.AddSubPage$}}">Add sub page</button>
                <button type="button" value="{{model.ReplaceSubPage$::click}}" onmouseup="++this.value;" disabled="{{model.ReplaceSubPage$}}">Replace first sub page</button>
                <button type="button" value="{{model.ClearSubPages$::click}}" onmouseup="++this.value;" disabled="{{model.ClearSubPages$}}">Clear sub pages</button>
            </p>
        </fieldset>
        <fieldset>
            <legend>Link</legend>
            <a href="/playground">Reload current model</a>
            <a href="/playground/reset">Reset values in current model</a>
            <a href="/playground/change">Change current model</a>
            <div>
                <input type="text" value="{{model.RedirectUrl$::change}}" placeholder="Redirect URL" />
            </div>
        </fieldset>
        <fieldset>
            <legend>Array of arrays</legend>
            <starcounter-include partial="{{model.MatrixPage}}"></starcounter-include>
        </fieldset>
        <link is="puppet-redirect" history url$="{{model.RedirectUrl$}}" />
    </template>
    <script>
        (function () {
            var template = (document._currentScript || document.currentScript).previousElementSibling;
        })();
    </script>
    <puppet-client usewebsocket="false" ref="root"></puppet-client>
    <script>
        (function () {
            var puppet = (document._currentScript || document.currentScript).previousElementSibling;
            
            puppet.addEventListener("connectionerror", function (e) {
                e.detail.handled = true;
                console.error("Connection error reload the page.");
            });
        })();
    </script>
    <starcounter-debug-aid></starcounter-debug-aid>
</body>
</html>
